{% extends 'base.html' %}
{% block content %}
<!-- Messages -->
{% for message in messages %}
  <div class="alert {% if 'success' in message.tags %}alert-success{% elif 'error' in message.tags %}alert-danger{% elif 'warning' in message.tags %}alert-warning{% elif 'info' in message.tags %}alert-info{% else %}alert-secondary{% endif %} alert-dismissible fade show" role="alert">
    {{ message }}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
{% endfor %}

<div class="container mt-4">
    <h1 class="text-center">My Appointments</h1>
  <div class="container view-appointments">
    <h2 class="mt-3">Upcoming Appointments</h2>
    <div class="row gap-3">
      {% for appt in upcoming_appointments %}
      <div class="col">
        <div class="card p-2">
          <h5>Dr, {{ appt.doctor.user.get_full_name }}</h5>
          <p class="mb-1">{{ appt.doctor.specialization }}</p>
          <p class="mb-1">{{ appt.reason }}</p><hr>
          <p class="fw-bold">{{ appt.appointment_date|date:"F j, Y" }} | {{ appt.appointment_time|time:"g:i A" }}</p>
          <div class="d-flex justify-content-between align-items-center mt-3 bg-secondary-subtle py-1 px-2 rounded-2">
            <span class="badge bg-success px-3 py-2">
              <i class="bi bi-check-circle me-1"></i>
              Status: {{appt.status}}
            </span>

            <button class=" btn status btn-sm">Reschedule</button>
          </div>
        </div>
      </div>
      {% empty %}
      <p>No upcoming appointments</p>
      {% endfor %}
    </div>
  </div>
    
  <div class="container view-appointments">
    <h2 class="mt-5">Past Appointments</h2>
    <div class="row">
      {% for appt in past_appointments %}
      <div class="col mb-3">
        <div class="card p-2">
          <h5>Dr, {{ appt.doctor.user.get_full_name }}</h5>
          <p class="mb-1">{{ appt.doctor.specialization }}</p><hr>
          <p class="fw-bold">{{ appt.appointment_date|date:"F j, Y" }} | {{ appt.appointment_time|time:"g:i A" }}</p>
          <div class="d-flex justify-content-between align-items-center mt-3 bg-secondary-subtle py-1 px-2 rounded-2">
            {% if appt.status == 'completed' %}
            <span class="badge bg-secondary px-3 py-2">
              <i class="bi bi-check-circle me-1"></i>
              Status: {{appt.status}}
            </span>
            {% elif appt.status == 'cancelled' %}
            <span class="badge bg-danger px-3 py-2">
            <i class="bi bi-check-circle me-1"></i>
              Status: {{appt.status}}
            </span>
            {% endif %}
            <button class=" btn status btn-sm">View details</button>
          </div>
        </div>
      </div>
      {% empty %}
      <p>No past appointments</p>
      {% endfor %}
    </div>
  </div>
    

  
</div>
{% endblock %}